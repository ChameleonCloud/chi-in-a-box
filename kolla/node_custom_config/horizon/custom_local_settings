from openstack_dashboard.settings import HORIZON_CONFIG
from os import environ

# Kolla-ansible defaults this to 'internalURL', which doesn't work when
# we need to access another region from across the public internet. Need
# to unfortunately default to 'public' interface for all endpoints as it is
# not currently possible (?) to use a different value here depending on which
# region is being used.
OPENSTACK_ENDPOINT_TYPE = 'publicURL'

# Default user to specific region on login.
DEFAULT_SERVICE_REGIONS = {
  '{{ horizon_keystone_url }}': '{{ openstack_region_name }}',
}

SITE_BRANDING = 'ChameleonCloud'

# Override help menu to point to our docs.
HORIZON_CONFIG['help_url'] = '{{ horizon_help_url }}'

# Used for Blazar dashboard, which needs to pull data from the MySQL database
# directly at the moment.
DATABASES = {
  'default': {},
{% for conf in horizon_regions %}
{% if conf.blazar_database_host is defined %}
  'blazar-{{ conf.region_name }}': {
    'ENGINE': 'django.db.backends.mysql',
    'NAME': '{{ conf.blazar_database_name }}',
    'HOST': '{{ conf.blazar_database_host }}',
    'PORT': '{{ conf.blazar_database_port }}',
    'USER': '{{ conf.blazar_database_user }}',
    'PASSWORD': '{{ conf.blazar_database_password }}',
  },
{% endif %}
{% endfor %}
}

# Add default Chameleon theme.
AVAILABLE_THEMES = [
  ('default', 'Default', 'themes/default'),
  ('chameleoncloud', 'ChameleonCloud', '/etc/openstack-dashboard/themes/chameleoncloud'),
]
DEFAULT_THEME = 'chameleoncloud'

# Used by server instance page to create links from the instance overview
# to the resource catalog.
CHAMELEON_PORTAL_API_BASE_URL = 'https://www.chameleoncloud.org'
CHAMELEON_SITES = {
{% for conf in horizon_regions %}
  '{{ conf.region_name }}': '{{ conf.chameleon_site_name }}',
{% endfor %}
}

{% if enable_horizon_chameleon_websso | bool %}
# Single-sign on support
WEBSSO_ENABLED = True
AUTHENTICATION_URLS = ['openstack_dashboard.cc_web_sso_urls','openstack_auth.urls',]
CHAMELEON_PORTAL_SSO_BASE_URL = '{{ horizon_chameleon_websso_host }}'
CHAMELEON_PORTAL_SSO_LOGIN_PATH = '/sso/horizon/'
CHAMELEON_PORTAL_SSO_LOGOUT_PATH = '/logout/'
SSO_CALLBACK_HOST = '{{ kolla_external_fqdn }}'
{% endif %}
