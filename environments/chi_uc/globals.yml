---
docker_namespace: "kolla"
docker_registry_username: "kolla"
docker_registry: "docker.chameleoncloud.org"
kolla_base_distro: "centos"
kolla_install_type: "source"
virtualenv: /etc/ansible/venv
pip_virtualenv: "{{ virtualenv }}"
ansible_python_interpreter: "{{ virtualenv }}/bin/python"

# Docker image tag to use for deployed containers
openstack_release: "chameleoncloud-ocata"
blazar_tag: "chameleoncloud-rocky"
glance_tag: "chameleoncloud-rocky"
heat_tag: "chameleoncloud-rocky"

# TODO: merge this inforation with the neutron_ml2_generic_switch_configs
switch_configs:
  - name: chameleon-corsa1
    device_type: corsa_dp2100
    ip: 172.30.0.4
    token: "{{ chameleon_switch_corsa1_token }}"
  - name: chameleon-corsa2
    device_type: corsa_dp2100
    ip: 172.30.0.5
    token: "{{ chameleon_switch_corsa2_token }}"
  - name: chameleon-spine
    device_type: netmiko_juniper
    ip: 10.140.80.54
    snmp:
      community_string: "{{ juniper_switch_community_string }}"
  - name: Chameleon-Cloud
    device_type: netmiko_dell_force10
    ip: 10.140.80.52
    snmp:
      community_string: "{{ dell_switch_community_string }}"
  - name: Chameleon-Compute
    device_type: netmiko_dell_force10
    ip: 10.140.80.53
    snmp:
      community_string: "{{ dell_switch_community_string }}"

# Network configuration
kolla_internal_vip_address: "10.140.81.2"
kolla_external_vip_address: "192.5.87.2"
kolla_external_fqdn: "chi.uc.chameleoncloud.org"
# This is for non-OpenStack services like JupyterHub
external_vip_address: "192.5.87.6"

# Multi-region configuration
openstack_region_name: "CHI@UC"
# Site name, similar to region but used for out-of-band inventory management
chameleon_site_name: "uc"
openstack_keystone_auth_url: "https://{{ kolla_external_fqdn }}:5000"
# TACC
chi_tacc_openstack_region_name: "CHI@TACC"
chi_tacc_chameleon_site_name: "tacc"
chi_tacc_blazar_database_host: "129.114.97.205"
chi_tacc_external_fqdn: "chi.tacc.chameleoncloud.org"
chi_tacc_keystone_auth_url: "https://{{ chi_tacc_external_fqdn }}:5000"

# Keystone's DB is replicated; ensure any writes happen against master
keystone_primary_region_name: "{{ chi_tacc_openstack_region_name }}"
openstack_auth:
  auth_url: "{{ chi_tacc_keystone_auth_url }}"

# External MariaDB config
enable_mariadb: "no"
use_preconfigured_databases: "no"
database_address: "fx2-01"

# External TLS config
enable_haproxy: "yes"
kolla_enable_tls_external: "yes"

# Kolla sidecar/support containers
enable_chrony: "yes"
enable_fluentd: "yes"
enable_memcached: "yes"
# External RabbitMQ
enable_rabbitmq: "no"

enable_cinder: "no"
enable_gnocchi: "no"
enable_grafana: "no"
enable_swift: "no"

# Docker registry
docker_registry_readonly_user: registry

# Jenkins
jenkins_slave_name: ansible-uc-prod

# Blazar
enable_blazar: "yes"
blazar_minutes_before_end_lease: 2880 # When to send lease notification email
blazar_default_max_lease_duration: 604800 # 7 days
blazar_usage_db_host: "{{ kolla_external_fqdn }}"
blazar_usage_default_allocated: 20000.0
blazar_usage_project_exemptions:
  - Chameleon
  - maintenance
blazar_database_address: "{{ database_address }}:{{ database_port }}"
blazar_floatingip_billrate: 0.0

# Glance
enable_glance: "yes"
glance_file_datadir_volume: /var/lib/glance
# TODO [jca-2019-01-29]: remove this when we are on Rocky.
# Override 'disabled' state of Glance Registry. This service was deprecated
# but we still need to include it for Ocata.
glance_services:
  glance-registry:
    enabled: true

# Heat
enable_heat: "yes"

# Horizon
enable_horizon: "yes"
enable_horizon_ironic: "yes"
enable_horizon_chameleon_websso: "yes"
horizon_help_url: https://chameleoncloud.readthedocs.io/en/latest/technical/baremetal.html
horizon_redirect_root: /dashboard
horizon_chameleon_websso_host: https://www.chameleoncloud.org
horizon_regions:
  - region_name: "{{ openstack_region_name }}"
    chameleon_site_name: "{{ chameleon_site_name }}"
    blazar_database_host: "fx2-01"
    blazar_database_name: "{{ blazar_database_name }}"
    blazar_database_port: "{{ blazar_database_port }}"
    blazar_database_user: "{{ blazar_database_user }}"
    blazar_database_password: "{{ blazar_database_password }}"
  - region_name: "{{ chi_tacc_openstack_region_name }}"
    chameleon_site_name: "{{ chi_tacc_chameleon_site_name }}"
    blazar_database_host: "{{ chi_tacc_blazar_database_host }}"
    blazar_database_name: "{{ blazar_database_name }}"
    blazar_database_port: "{{ blazar_database_port }}"
    blazar_database_user: "{{ blazar_database_user }}"
    blazar_database_password: "{{ chi_tacc_blazar_database_password }}"

# Ironic
enable_ironic: "yes"
ironic_provisioning_network: ironic-provisioning-network
ironic_cleaning_network: "{{ ironic_provisioning_network }}"
ironic_image_cache_size: 180000 # MB
ironic_pxe_append_params: "nofb nomodeset vga=normal console=tty0 console=ttyS0,9600 systemd.journald.forward_to_console=yes rootpwd={{ ironic_pxe_root_password }}"

# Keystone
enable_keystone: "yes"
keystone_admin_project: "openstack"
fernet_token_expiry: 604800 # 1 week

# Neutron
enable_neutron: "yes"
enable_openvswitch: "{{ enable_neutron }}"
# TODO [jca 2019-01-29]: remove this when we can take advantage of this
# component, which was introduced after Ocata.
enable_ironic_neutron_agent: "no"
chameleon_switch_dell_username: chamadm
chameleon_switch_fx2_username: root
# Enable notifications for Experiment Precis
neutron_notification_topics:
  - name: "notifications"
    enabled: "yes"
neutron_type_drivers: flat,vlan
neutron_tenant_network_types: vlan
neutron_bridge_name: br-em1,br-ex,br-exogeni
neutron_external_interface: em1,em2,br-em1
neutron_ovs_bridge_mappings: physnet1:br-em1,public:br-ex,exogeni:br-exogeni
neutron_network_vlan_ranges: physnet1:3010:3228,exogeni:3290:3290,exogeni:3299:3299
neutron_ml2_generic_switch_configs:
  - name: Chameleon-Cloud
    device_type: netmiko_dell_force10
    ip: 10.140.80.52
    username: "{{ chameleon_switch_dell_username }}"
    password: "{{ chameleon_switch_dell_password }}"
  - name: Chameleon-Compute
    device_type: netmiko_dell_force10
    ip: 10.140.80.53
    username: "{{ chameleon_switch_dell_username }}"
    password: "{{ chameleon_switch_dell_password }}"
  - name: fx2-chassis-01-agg1
    device_type: fnioa_netmiko_dell_force10
    ip: 172.29.0.197
    username: "{{ chameleon_switch_fx2_username }}"
    password: "{{ chameleon_switch_fx2_password }}"
  - name: fx2-chassis-02-agg1
    device_type: fnioa_netmiko_dell_force10
    ip: 172.29.0.199
    username: "{{ chameleon_switch_fx2_username }}"
    password: "{{ chameleon_switch_fx2_password }}"
  - name: fx2-chassis-03-agg1
    device_type: fnioa_netmiko_dell_force10
    ip: 172.29.0.201
    username: "{{ chameleon_switch_fx2_username }}"
    password: "{{ chameleon_switch_fx2_password }}"
  - name: fx2-chassis-04-agg1
    device_type: fnioa_netmiko_dell_force10
    ip: 172.29.0.203
    username: "{{ chameleon_switch_fx2_username }}"
    password: "{{ chameleon_switch_fx2_password }}"
  - name: chameleon-corsa1
    device_type: corsa_dp2100
    switchIP: 172.30.0.4
    token: "{{ chameleon_switch_corsa1_token }}"
    chameleon-corsa2: 37
    controllerNamespace: of-mgt
    defaultControllerIP: 172.30.0.101
    defaultControllerPort: 6653
    defaultVFCName: UNNAMED
    defaultVFCRes: 2
    provisioningControllerIP: 172.17.1.1
    provisioningControllerPort: 6653
    provisioningVFCType: l2-vpn
    provisioningVLAN: 3111
    sharedNonByocProvider: physnet1
    sharedNonByocVFC: br63
    sharedNonByocVLAN: 3010:3288
    uplink_ports: 33
    VFCHost: True
    VFCType: openflow
    # Mappings of physical ports to OpenFlow port numbers
    'P 1': 101
    'P 2': 102
    'P 3': 103
    'P 4': 104
    'P 5': 105
    'P 6': 106
    'P 7': 107
    'P 8': 108
    'P 9': 109
    'P 10': 110
    'P 11': 111
    'P 12': 112
    'P 13': 113
    'P 14': 114
    'P 15': 115
    'P 16': 116
    'P 17': 117
    'P 18': 118
    'P 19': 119
    'P 20': 120
    'P 21': 121
    'P 22': 122
    'P 23': 123
    'P 24': 124
    'P 25': 125
    'P 26': 126
    'P 27': 127
    'P 28': 128
    'P 29': 129
    'P 30': 130
    'P 31': 131
    'P 32': 132
  - name: chameleon-corsa2
    device_type: corsa_dp2100
    switchIP: 172.30.0.5
    token: "{{ chameleon_switch_corsa2_token }}"
    controllerNamespace: of-mgt
    defaultControllerIP: 172.30.0.102
    defaultControllerPort: 6653
    defaultVFCName: UNNAMED
    defaultVFCRes: 2
    provisioningControllerIP: 172.17.1.1
    provisioningControllerPort: 6653
    provisioningVFCType: l2-vpn
    provisioningVLAN: 3111
    sharedNonByocProvider: physnet1
    sharedNonByocVFC: br63
    sharedNonByocVLAN: 3010:3288
    uplink_ports: 37
    VFCHost: False
    VFCType: openflow
    # Mappings of physical ports to OpenFlow port numbers
    'P 1': 133
    'P 2': 134
    'P 3': 135
    'P 4': 136
    'P 5': 137
    'P 6': 138
    'P 7': 139
    'P 8': 140
    'P 9': 141
    'P 10': 142
    'P 11': 143
    'P 12': 144
    'P 13': 145
    'P 14': 146
    'P 15': 147
    'P 16': 148
    'P 17': 149
    'P 18': 150
    'P 19': 151
    'P 20': 152
    'P 21': 153
    'P 22': 154
    'P 23': 155
    'P 24': 156
    'P 25': 157
    'P 26': 158
    'P 27': 159
    'P 28': 160
    'P 29': 161
    'P 30': 162
    'P 31': 163
    'P 32': 164

# Nova
enable_nova: "yes"
enable_nova_serialconsole_proxy: "yes"
nova_compute_virt_type: "none"
# We are not using any VNC consoles; the serialproxy is not considered a 'nova_console'
nova_console: "none"
nova_console_allowed_origins: "{{ chi_tacc_external_fqdn }}"
# We override the endpoints to not include %(tenant_id)s placeholder.
# Blazar in particular needs this to not be scoped to the tenant because when
# it tries to perform actions on behalf of a user, it uses a different tenant
# id (its own).
nova_admin_endpoint: "{{ admin_protocol }}://{{ kolla_internal_fqdn }}:{{ nova_api_port }}/v2.1"
nova_internal_endpoint: "{{ internal_protocol }}://{{ kolla_internal_fqdn }}:{{ nova_api_port }}/v2.1"
nova_public_endpoint: "{{ public_protocol }}://{{ kolla_external_fqdn }}:{{ nova_api_port }}/v2.1"
instance_metrics_writer_username: "instance_metrics_writer"

# Prometheus
prometheus_alertmanager_hostname: alert.uc.chameleoncloud.org

# Rabbit admin
rabbitmq_user: openstack
